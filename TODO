Optimize optimizePhonology to include directionality
